---
title: 面向对象之观察者模式
categories: 面向对象设计
---

### 为何观察者存在

作为一个整体，不管是类库还是软件应用，其包含的类一定不止一个，控件也不止一个。而且，这些类和控件，有着看似复杂，又看似简单的联系。

其实，观察者这种面向对象模式应用的领域很特定，就是一对多的通知。也就是对象间某种形式的同步，而且只有一个是主动的，其余都是被动监听，并根据提醒消息采取行动。

### 实现逻辑

一个通知者，必然有几个要求：

1. 拥有一系列被通知者，也就是观察者的实例
2. 实现提醒接口
3. 在提醒接口里调用观察者的更新接口

一个观察者，必然有几个要求：

1. 一个共同的观察者抽象类，这样才能即被一个通知者拥有，又对应不同的类别，拥有不同的逻辑
2. 实现更新接口

说直白点，通知者就是观察者的上帝，它拥有全部观察者实例，然后在自己想要的任何时候，通知观察者（调用观察者更新方法），实现一次通知。

### 现实问题

在不同类型的观察者中，在非自己控制的类，或者难以更改适配抽象类的类时，实现同一个抽象类是有难度的。所以有了委托，也就是函数对象（也可理解为函数指针）的概念。只要是函数的签名相同，其就可以充当观察者的角色，在通知者通知时，将委托对象对应的方法当成是观察者需要实现的方法。

再复杂的讨论，就是所谓的面向对象里的事件机制了。以后有深入研究在谈论吧。

### 总结

观察者模式在面向对象的概念里，主要的应用也就是事件机制了。这样从事件机制角度本身，可以看出面向对象体系在某种程度上的复杂，不论是对象本身，还是之间的关系，观察者模式提供了一种通信，同步，或完成业务逻辑的一种新的思想方式。