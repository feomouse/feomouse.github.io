---
title: 软件建模认知4（客户端和服务器端）
categories: 软件构造思想
---

### 前言

本文讨论的是一种常见的软件架构形式-客户端和服务器端。而我们日常对计算机和互联网的使用也常常是这种模式。

对于这个架构形式，更多的是从物理节点的部署和系统承担的角色功能的不同来分类区别的。也就是说，客户端的子系统和服务端的子系统都是整个软件系统的一部分，从主/子系统的角度来看，只是子系统或构件承担的功能不一样。但是在这个讨论背景下，客户和服务被当成了两个重点，核心概念进行讨论。

### 客户端/服务器端的结构模式

在客户端/服务器端的结构模式下，更多的是说客户端和服务端子系统的交互数量和通信模式。

在系统的设计上，其实和普通架构的软件一样，将客户端设计成一个或几个构件，承担一定的功能；将服务端设计成另一些构件，承担另一些功能。但是在实际部署到物理节点的时候，客户端构件正常是很多的，而服务器端则相比少很多。可以分为以下几类：

* 多个客户端，一个服务器端
* 多个客户端，多个服务器端
* 多个客户端，多个服务器端，而且有些服务器端又充当客户端，又充当服务器端，也就是多层结构模式

在以上几种情况下，其实也是比较好理解，如果客户需要使用的服务较简单，可以由一个服务器端完成，那么就会有一对多的模式。那如果客户需要比较复杂的服务器端功能，需要分别配到不同的服务端执行，那么可能会又多客户端，多服务器端的模式。

而多层则可能是需要自身系统作为中介调用原本不属于自身业务软件的外界服务器端构件。

### 通信

客户端与服务器端的通信形式多种多样：

* 带回复的同步消息通信：客户端发出请求，服务端需要响应，而且客户端需要阻塞到收到服务端回应才可继续执行工作。

* 异步消息通信：客户端发出请求，服务端接到通信请求可以不用响应，客户端在发出消息通信后也不会阻塞工作。

* 带回调的异步消息通信：客户端发出请求后，自己继续工作而不会阻塞，服务端在接收到调用请求后处理，过后会根据之前客户端提供的句柄，调用客户端句柄。

* 不带回复的同步通信：这种情况主要是一端与另一端需要持续同步通信，而不需要反馈。

* 代理者模式：在通信的双方间加入一个第三方，这个第三方可以进行通信的转发，也可以提供一些信息使通信双方直接通信。

* 群组通信模式：这种通信模式一般分为广播和订阅通知两种模式。发起方将消息发给每一个连接方，连接方有权决定通信的结果。而订阅通知则是接收方可以订阅与取消订阅消息，于是发送方会根据订阅目录向指定群组发送消息。

### 服务子系统设计

在服务子系统方，需要考虑到接收客户端的连接请求，并处理任务，执行服务，所以需要考虑到如果有多个用户请求服务，那么如何维持客户连接，如何有序处理用户请求。比如通常可以维持一个队列来处理客户的请求连接，而服务内部工作可以为了提高效率而采用一些并行执行任务的策略。

### 总结

以上是对服务端和客户端架构的一些讨论，不深入，但也能进行粗浅的认识。